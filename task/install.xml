<project>
	<!-- main tasks -->
	<target name="install" depends="config,install-gems" description="install all libraries including bin and git submodules" />
	<target name="update" depends="submodules-update,install-gems" description="update all libraries including bin and git submodules" />

	<target name="install-gems" description="install required gems">
		<if>
			<isset property="ruby.gems" />
			<then>
				<fail unless="ruby.gems" message="no ruby gems defined in ruby.gems" />
				<echo msg="update ruby gem libraries" />
				<echo msg="this will require root rights, please enter root password:" />
				<exec escape="false" checkreturn="true" passthru="true" command="sudo gem update --system" />
				<echo msg="install gems ${ruby.gems} (from build.properties)" />
				<exec escape="false" checkreturn="true" passthru="true" command="sudo gem install ${ruby.gems}" />
			</then>
		</if>
	</target>

	<!-- git stuff -->
	<target name="submodules-install" description="install required git modules">
		<exec escape="false" checkreturn="true" passthru="true" command="git submodule init" />
		<phingcall target="submodules-update" />
	</target>
	<target name="submodules-list" description="list installed/required git modules">
		<exec escape="false" checkreturn="true" passthru="true" command="cat .gitmodules" />
	</target>
	<target name="submodules-update" description="update all git modules">
		<echo level="info" msg="updating git submodules" />
		<exec escape="false" checkreturn="true" passthru="true" command="git submodule foreach git pull origin master" />
	</target>
</project>